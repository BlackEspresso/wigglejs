(function(){var v,y,s,F,t,w,G,H;w=function(a,g){var h;h=new Image;h.src=a;return G(h,g)};G=function(a,g){return a.onload=function(){var h,l,f;l=a.width;h=a.height;f=document.createElement("canvas");f.width=l;f.height=h;f=f.getContext("2d");f.drawImage(a,0,0,l,h);return g(f.getImageData(0,0,l,h))}};F=function(a,g){return document.createElement("canvas").getContext("2d").createImageData(a,g)};H=function(a,g,h,l,f){var n,m,e,q,I,u,p,r,x,v,s,k,t,z,A,B,C,D,E,w,y;m=h*l*4;s=F(h,l);m=new Float32Array(m);
console.time("render_scene");q=h/2|0;k=l/2|0;v=g[4*(q+h*k)];p=0;n=f.a;console.time("render_scene_inner");r=f.x-q;x=f.y-k;q-=f.x;I=k-f.y;for(f=B=0;B<l;f=B+=1)for(k=C=0;C<h;k=C+=1){e=g[p]-v;e=n/(n-e);z=q+(r+k)*e;A=I+(x+f)*e;t=z|0;u=D=k=A|0;for(w=k+1;D<=w;u=D+=1)if(0<=u&&u<l)for(e=E=t,y=t+1;E<=y;e=E+=1)0<=e&&e<h&&(k=4*(e+h*u),e=(z-e)*(z-e)+(A-u)*(A-u),e=1-e/2.4,e*=e,e*=e,m[k]+=a[p]*e,m[++k]+=a[p+1]*e,m[++k]+=a[p+2]*e,m[++k]+=e);p+=4}console.timeEnd("render_scene_inner");console.time("paint");a=s.data;
for(f=g=0;0<=l?g<l:g>l;f=0<=l?++g:--g)for(k=n=0;0<=h?n<h:n>h;k=0<=h?++n:--n)if(k=4*(k+h*f),e=m[k+3],a[k+3]=255,0!==e)for(p=r=k,x=k+2;r<=x;p=r+=1)a[p]=m[p]/e|0;else for(p=r=k,x=k+2;r<=x;p=r+=1)a[p]=a[p-4];console.timeEnd("paint");console.timeEnd("render_scene");return s};v=function(){function a(a){this.frames=a;if(0===this.frames.length)throw"Your animation requires at least one frame.";}a.prototype.height=function(){return this.frames[0].height};a.prototype.width=function(){return this.frames[0].width};
return a}();y=function(a,g){return{x:Math.cos(g)*a,y:Math.sin(g)*a,a:3E3}};t=function(a){var g,h,l,f;g=4*a.width*a.height;h=new Float32Array(g);a=a.data;for(l=f=0;0<=g?f<g:f>g;l=0<=g?++f:--f)h[l]=a[l];return h};s=function(a,g,h){var l,f,n;f=a.width;l=a.height;a=t(a);n=t(g);var m,e,q;q=[];m=0;for(e=h.length;m<e;m++)g=h[m],q.push(H(a,n,f,l,g));return new v(q)};window.d=function(a,g,h,l){var f,n,m,e;e=function(){var a,e;e=[];for(n=a=0;12>a;n=++a)e.push(2*Math.PI*n/12);return e}();f=function(){var a,
f,g;g=[];a=0;for(f=e.length;a<f;a++)m=e[a],g.push(y(60,m));return g}();return w(a,function(a){return w(g,function(e){return l(s(a,e,f))})})};window.c=s;window.b=v}).call(this);
